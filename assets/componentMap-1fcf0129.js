var xe=Object.defineProperty,et=Object.defineProperties;var tt=Object.getOwnPropertyDescriptors;var Fe=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable;var $e=(e,a,t)=>a in e?xe(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,k=(e,a)=>{for(var t in a||(a={}))at.call(a,t)&&$e(e,t,a[t]);if(Fe)for(var t of Fe(a))nt.call(a,t)&&$e(e,t,a[t]);return e},x=(e,a)=>et(e,tt(a));var D=(e,a,t)=>new Promise((r,o)=>{var g=l=>{try{i(t.next(l))}catch(n){o(n)}},m=l=>{try{i(t.throw(l))}catch(n){o(n)}},i=l=>l.done?r(l.value):Promise.resolve(l.value).then(g,m);i((t=t.apply(e,a)).next())});import{u as ce}from"./useFormItem-192ac42b.js";import{p as b,q as Pe,k as Y,_ as q,K as oe,O as ot,I as Oe,Q as lt,R as st,f as rt,S as it,M as ke,b as Ie,U as Ue,w as De}from"./index.js";import{ak as ue,o as se,e as G,ae as ee,W as Be,al as Se,am as ut,an as Me,ao as ye,ap as ct,a5 as Ne,aq as dt,T as Ee,k as pt,ai as ft,ar as mt,as as gt,Q as ge,at as be,a2 as ht,Y as vt,au as yt,M as bt,E as re,av as St,aw as wt,ax as Ct,a4 as ze,ay as _t,az as At,aA as de,aB as Ge}from"./antd-65489578.js";import{d as j,f as S,c as P,h as we,w as N,u as w,a7 as A,Z as _,a8 as L,a9 as $,_ as E,aa as ie,F as ae,E as H,a0 as z,ac as X,ad as pe,N as fe,ai as ne,aj as me,l as v,$ as le,o as Ce,p as Ft,e as $t,H as Re,a1 as he,ab as W,x as Le,r as kt,G as je}from"./vue-ea98dac5.js";import{R as Rt}from"./RadioButtonGroup-3e84979d.js";import{u as Lt,B as Ke,a as We,b as Te}from"./index-5d733051.js";import{b as Tt}from"./uuid-31b8b5a4.js";import{u as Pt}from"./useSortable-3cb9ef53.js";import{d as Ot}from"./download-2647fd8d.js";import{S as It}from"./index-b6bcc265.js";import{_ as Ut}from"./IconPicker.vue_vue_type_script_setup_true_lang-cd895ca2.js";import{C as Dt}from"./index-ddb99338.js";const Bt=j({name:"ApiRadioGroup",components:{RadioGroup:ue.Group,RadioButton:ue.Button,Radio:ue},props:{api:{type:Function,default:null},params:{type:[Object,String],default:()=>({})},value:{type:[String,Number,Boolean]},isBtn:{type:[Boolean],default:!1},numberToString:b.bool,resultField:b.string.def(""),labelField:b.string.def("label"),valueField:b.string.def("value"),immediate:b.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:a}){const t=S([]),r=S(!1),o=S(!0),g=S([]),m=Pe(),{t:i}=Y(),[l]=ce(e,"value","change",g),n=P(()=>{const{labelField:d,valueField:c,numberToString:f}=e;return w(t).reduce((I,T)=>{if(T){const O=T[c];I.push(k({label:T[d],value:f?`${O}`:O},se(T,[d,c])))}return I},[])});we(()=>{e.immediate&&u()}),N(()=>e.params,()=>{!w(o)&&u()},{deep:!0});function u(){return D(this,null,function*(){const d=e.api;if(!(!d||!G(d))){t.value=[];try{r.value=!0;const c=yield d(e.params);if(Array.isArray(c)){t.value=c,s();return}e.resultField&&(t.value=ee(c,e.resultField)||[]),s()}catch(c){}finally{r.value=!1}}})}function s(){a("options-change",w(n))}function p(...d){g.value=d}return{state:l,getOptions:n,attrs:m,loading:r,t:i,handleClick:p,props:e}}});function Mt(e,a,t,r,o,g){const m=A("RadioButton"),i=A("Radio"),l=A("RadioGroup");return _(),L(l,X(e.attrs,{value:e.state,"onUpdate:value":a[0]||(a[0]=n=>e.state=n),"button-style":"solid"}),{default:$(()=>[(_(!0),E(ae,null,ie(e.getOptions,n=>(_(),E(ae,{key:`${n.value}`},[e.props.isBtn?(_(),L(m,{key:0,value:n.value,disabled:n.disabled,onClick:u=>e.handleClick(n)},{default:$(()=>[H(z(n.label),1)]),_:2},1032,["value","disabled","onClick"])):(_(),L(i,{key:1,value:n.value,disabled:n.disabled,onClick:u=>e.handleClick(n)},{default:$(()=>[H(z(n.label),1)]),_:2},1032,["value","disabled","onClick"]))],64))),128))]),_:1},16,["value"])}const Nt=q(Bt,[["render",Mt]]),Et=j({name:"ApiSelect",components:{Select:Be,LoadingOutlined:Se},inheritAttrs:!1,props:{value:{type:[Array,Object,String,Number]},numberToString:b.bool,api:{type:Function,default:null},params:b.any.def({}),resultField:b.string.def(""),labelField:b.string.def("label"),valueField:b.string.def("value"),immediate:b.bool.def(!0),alwaysLoad:b.bool.def(!1),options:{type:Array,default:[]}},emits:["options-change","change","update:value"],setup(e,{emit:a}){const t=S([]),r=S(!1),o=S(!1),g=S([]),m=Pe(),{t:i}=Y(),[l]=ce(e,"value","change",g),n=P(()=>{const{labelField:c,valueField:f,numberToString:I}=e;let T=w(t).reduce((O,K)=>{if(K){const J=ee(K,f);O.push(x(k({},se(K,[c,f])),{label:ee(K,c),value:I?`${J}`:J}))}return O},[]);return T.length>0?T:e.options});N(()=>l.value,c=>{a("update:value",c)}),N(()=>e.params,()=>{!w(o)&&u()},{deep:!0,immediate:e.immediate});function u(){return D(this,null,function*(){const c=e.api;if(!(!c||!G(c)||r.value)){t.value=[];try{r.value=!0;const f=yield c(e.params);if(o.value=!0,Array.isArray(f)){t.value=f,p();return}e.resultField&&(t.value=ee(f,e.resultField)||[]),p()}catch(f){}finally{r.value=!1,o.value=!1}}})}function s(c){return D(this,null,function*(){c&&(e.alwaysLoad?yield u():!e.immediate&&!w(o)&&(yield u()))})}function p(){a("options-change",w(n))}function d(c,...f){g.value=f}return{state:l,attrs:m,getOptions:n,loading:r,t:i,handleFetch:s,handleChange:d}}});function zt(e,a,t,r,o,g){const m=A("LoadingOutlined"),i=A("Select");return _(),L(i,X({onDropdownVisibleChange:e.handleFetch},e.$attrs,{onChange:e.handleChange,options:e.getOptions,value:e.state,"onUpdate:value":a[0]||(a[0]=l=>e.state=l)}),pe({_:2},[ie(Object.keys(e.$slots),l=>({name:l,fn:$(n=>[fe(e.$slots,l,ne(me(n||{})))])})),e.loading?{name:"suffixIcon",fn:$(()=>[v(m,{spin:""})]),key:"0"}:void 0,e.loading?{name:"notFoundContent",fn:$(()=>[le("span",null,[v(m,{spin:"",class:"mr-1"}),H(" "+z(e.t("component.form.apiSelectNotFound")),1)])]),key:"1"}:void 0]),1040,["onDropdownVisibleChange","onChange","options","value"])}const Gt=q(Et,[["render",zt]]),jt=j({name:"ApiTree",components:{ATree:ut},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},resultField:b.string.def(""),afterFetch:{type:Function},value:{type:Array}},emits:["options-change","change","update:value"],setup(e,{attrs:a,emit:t}){const r=S([]),o=S(!1),g=S(!1),m=S([]),[i]=ce(e,"value","change",m),l=P(()=>k(k({},e.api?{treeData:w(r)}:{}),a));N(()=>i.value,u=>{t("update:value",u)}),N(()=>e.params,()=>{!w(o)&&n()},{deep:!0}),N(()=>e.immediate,u=>{u&&!o.value&&n()}),Ce(()=>{e.immediate&&n()});function n(){return D(this,null,function*(){const{api:u,afterFetch:s}=e;if(!u||!G(u))return;g.value=!0,r.value=[];let p;try{p=yield u(e.params)}catch(d){}s&&G(s)&&(p=s(p)),g.value=!1,p&&(oe(p)||(p=ee(p,e.resultField)),r.value=p||[],o.value=!0,t("options-change",r.value))})}return{getAttrs:l,loading:g,state:i}}});function Kt(e,a,t,r,o,g){const m=A("a-tree");return _(),L(m,X(e.getAttrs,{selectedKeys:e.state,"onUpdate:selectedKeys":a[0]||(a[0]=i=>e.state=i)}),pe({_:2},[ie(Object.keys(e.$slots),i=>({name:i,fn:$(l=>[fe(e.$slots,i,ne(me(l||{})))])}))]),1040,["selectedKeys"])}const Wt=q(jt,[["render",Kt]]),Ht=j({name:"ApiTreeSelect",components:{ATreeSelect:Me,LoadingOutlined:Se},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},async:{type:Boolean,default:!1},resultField:b.string.def(""),labelField:b.string.def("title"),valueField:b.string.def("value"),childrenField:b.string.def("children")},emits:["options-change","change","load-data"],setup(e,{attrs:a,emit:t}){const r=S([]),o=S(!1),g=S(!1),m=P(()=>k(k({},e.api?{treeData:w(r)}:{}),a)),i={children:e.childrenField,value:e.valueField,label:e.labelField};function l(...s){t("change",...s)}N(()=>e.params,()=>{!w(o)&&u()},{deep:!0}),N(()=>e.immediate,s=>{s&&!o.value&&u()}),Ce(()=>{e.immediate&&u()});function n(s){return new Promise(p=>{if(oe(s.children)&&s.children.length>0){p();return}t("load-data",{treeData:r,treeNode:s,resolve:p})})}function u(){return D(this,null,function*(){const{api:s}=e;if(!s||!G(s)||g.value)return;g.value=!0,r.value=[];let p;try{p=yield s(e.params)}catch(d){}g.value=!1,p&&(oe(p)||(p=ee(p,e.resultField)),r.value=p||[],o.value=!0,t("options-change",r.value))})}return{getAttrs:m,loading:g,handleChange:l,fieldNames:i,onLoadData:n}}});function Vt(e,a,t,r,o,g){const m=A("LoadingOutlined"),i=A("a-tree-select");return _(),L(i,X(e.getAttrs,{onChange:e.handleChange,"field-names":e.fieldNames,"load-data":e.async?e.onLoadData:void 0}),pe({_:2},[ie(Object.keys(e.$slots),l=>({name:l,fn:$(n=>[fe(e.$slots,l,ne(me(n||{})))])})),e.loading?{name:"suffixIcon",fn:$(()=>[v(m,{spin:""})]),key:"0"}:void 0]),1040,["onChange","field-names","load-data"])}const qt=q(Ht,[["render",Vt]]),Zt=j({name:"ApiCascader",components:{LoadingOutlined:Se,[ye.name]:ye},props:{value:{type:Array},api:{type:Function,default:null},numberToString:b.bool,resultField:b.string.def(""),labelField:b.string.def("label"),valueField:b.string.def("value"),childrenField:b.string.def("children"),apiParamKey:b.string.def("parentCode"),immediate:b.bool.def(!0),initFetchParams:{type:Object,default:()=>({})},isLeaf:{type:Function,default:null},displayRenderArray:{type:Array}},emits:["change","defaultChange"],setup(e,{emit:a}){const t=S([]),r=S([]),o=S(!1),g=S([]),m=S(!0),{t:i}=Y(),[l]=ce(e,"value","change",g);N(t,c=>{const f=n(c);r.value=f},{deep:!0});function n(c){const{labelField:f,valueField:I,numberToString:T,childrenField:O,isLeaf:K}=e;return c.reduce((J,Z)=>{if(Z){const C=Z[I],R=x(k({},se(Z,[f,I])),{label:Z[f],value:T?`${C}`:C,isLeaf:K&&typeof K=="function"?K(Z):!1}),h=Reflect.get(Z,O);h&&Reflect.set(R,O,n(h)),J.push(R)}return J},[])}function u(){return D(this,null,function*(){const c=e.api;if(!(!c||!G(c))){t.value=[],o.value=!0;try{const f=yield c(e.initFetchParams);if(Array.isArray(f)){t.value=f;return}e.resultField&&(t.value=ee(f,e.resultField)||[])}catch(f){}finally{o.value=!1}}})}function s(c){return D(this,null,function*(){const f=c[c.length-1];f.loading=!0;const I=e.api;if(!(!I||!G(I)))try{const T=yield I({[e.apiParamKey]:Reflect.get(f,"value")});if(Array.isArray(T)){const O=n(T);f.children=O;return}if(e.resultField){const O=n(ee(T,e.resultField)||[]);f.children=O}}catch(T){}finally{f.loading=!1}})}we(()=>{e.immediate&&u()}),N(()=>e.initFetchParams,()=>{!w(m)&&u()},{deep:!0});function p(c,f){g.value=f,a("defaultChange",c,f)}function d({labels:c,selectedOptions:f}){return w(g).length===f.length?c.join(" / "):e.displayRenderArray?e.displayRenderArray.join(" / "):""}return{state:l,options:r,loading:o,t:i,handleChange:p,loadData:s,handleRenderDisplay:d}}});function Qt(e,a,t,r,o,g){const m=A("LoadingOutlined"),i=A("a-cascader");return _(),L(i,{value:e.state,"onUpdate:value":a[0]||(a[0]=l=>e.state=l),options:e.options,"load-data":e.loadData,"change-on-select":"",onChange:e.handleChange,displayRender:e.handleRenderDisplay},pe({_:2},[e.loading?{name:"suffixIcon",fn:$(()=>[v(m,{spin:""})]),key:"0"}:void 0,e.loading?{name:"notFoundContent",fn:$(()=>[le("span",null,[v(m,{spin:"",class:"mr-1"}),H(" "+z(e.t("component.form.apiSelectNotFound")),1)])]),key:"1"}:void 0]),1032,["value","options","load-data","onChange","displayRender"])}const Xt=q(Zt,[["render",Qt]]),Yt=j({name:"ApiTransfer",components:{Transfer:ct},props:{value:{type:Array},api:{type:Function,default:null},params:{type:Object},dataSource:{type:Array},immediate:b.bool.def(!0),alwaysLoad:b.bool.def(!1),afterFetch:{type:Function},resultField:b.string.def(""),labelField:b.string.def("title"),valueField:b.string.def("key"),showSearch:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterOption:{type:Function},selectedKeys:{type:Array},showSelectAll:{type:Boolean,default:!1},targetKeys:{type:Array}},emits:["options-change","change"],setup(e,{attrs:a,emit:t}){const r=S([]),o=S([]),{t:g}=Y(),m=P(()=>k(k({},e.api?{}:{dataSource:w(r)}),a)),i=P(()=>{const{labelField:p,valueField:d}=e;return w(r).reduce((c,f)=>(f&&c.push(x(k({},se(f,[p,d])),{title:f[p],key:f[d]})),c),[])}),l=P(()=>Array.isArray(e.value)?e.value:Array.isArray(e.targetKeys)?e.targetKeys:[]);function n(p,d,c){o.value=p,t("change",p)}we(()=>{e.immediate&&!e.alwaysLoad&&u()}),N(()=>e.params,()=>{u()},{deep:!0});function u(){return D(this,null,function*(){const p=e.api;if(!p||!G(p)){Array.isArray(e.dataSource)&&(r.value=e.dataSource);return}r.value=[];try{const d=yield p(e.params);if(Array.isArray(d)){r.value=d,s();return}e.resultField&&(r.value=ee(d,e.resultField)||[]),s()}catch(d){}})}function s(){t("options-change",w(i))}return{getTargetKeys:l,getdataSource:i,t:g,getAttrs:m,handleChange:n}}});function Jt(e,a,t,r,o,g){const m=A("Transfer");return _(),L(m,{"data-source":e.getdataSource,"filter-option":e.filterOption,render:i=>i.title,showSelectAll:e.showSelectAll,selectedKeys:e.selectedKeys,targetKeys:e.getTargetKeys,showSearch:e.showSearch,disabled:e.disabled,onChange:e.handleChange},null,8,["data-source","filter-option","render","showSelectAll","selectedKeys","targetKeys","showSearch","disabled","onChange"])}const xt=q(Yt,[["render",Jt]]),He={listType:{type:String,default:"picture-card"},helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:1/0},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!0},uploadParams:{type:Object,default:()=>({})},api:{type:Function,default:null,required:!0},name:{type:String,default:"file"},filename:{type:String,default:null},fileListOpenDrag:{type:Boolean,default:!0},fileListDragOptions:{type:Object,default:()=>({})}},Ve=x(k({value:{type:Array,default:()=>[]}},He),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),ea={value:{type:Array,default:()=>[]}},ta={columns:{type:Array,default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null},openDrag:{type:Boolean,default:!1},dragOptions:{type:Object,default:()=>({})}},{t:ve}=Y();function qe({acceptRef:e,helpTextRef:a,maxNumberRef:t,maxSizeRef:r}){const o=P(()=>{const i=w(e);return i&&i.length>0?i:[]}),g=P(()=>w(o).map(i=>i.indexOf("/")>0||i.startsWith(".")?i:`.${i}`).join(",")),m=P(()=>{const i=w(a);if(i)return i;const l=[],n=w(e);n.length>0&&l.push(ve("component.upload.accept",[n.join(",")]));const u=w(r);u&&l.push(ve("component.upload.maxSize",[u]));const s=w(t);return s&&s!==1/0&&l.push(ve("component.upload.maxNumber",[s])),l.join("，")});return{getAccept:o,getStringAccept:g,getHelpText:m}}var B=(e=>(e.SUCCESS="success",e.ERROR="error",e.UPLOADING="uploading",e))(B||{});function aa(e){return _e(e.name)}function _e(e){return/\.(jpg|jpeg|png|gif|webp)$/i.test(e)}function na(e){return new Promise((a,t)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>a({result:r.result,file:e}),r.onerror=o=>t(o)})}const Ze=Symbol("basic-table");function Ya(e){Ft(Ze,e)}function oa(){return $t(Ze)}const{table:la}=ot,{pageSizeOptions:sa,defaultPageSize:ra,fetchSetting:ia,defaultSize:ua,defaultSortFn:ca,defaultFilterFn:da}=la,Ja="key",xa=sa,en=ra,tn=ia,an=ua,nn=ca,on=da,ln="center",sn="INDEX",pa="ACTION",fa=j({name:"TableAction",components:{Icon:Oe,PopConfirmButton:lt,Divider:Ne,Dropdown:st,MoreOutlined:dt,Tooltip:Ee},props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:b.bool.def(!0),outside:b.bool,stopButtonPropagation:b.bool.def(!1)},setup(e){const{prefixCls:a}=rt("basic-table-action");let t={};e.outside||(t=oa());const{hasPermission:r}=it();function o(u){const s=u.ifShow;let p=!0;return ft(s)&&(p=s),G(s)&&(p=s(u)),p}const g=P(()=>(Re(e.actions)||[]).filter(u=>r(u.auth)&&o(u)).map(u=>{const{popConfirm:s}=u;return x(k(k({getPopupContainer:()=>{var p;return(p=w(t==null?void 0:t.wrapRef))!=null?p:document.body},type:"link",size:"small"},u),s||{}),{onConfirm:s==null?void 0:s.confirm,onCancel:s==null?void 0:s.cancel,enable:!!s})})),m=P(()=>{const u=(Re(e.dropDownActions)||[]).filter(s=>r(s.auth)&&o(s));return u.map((s,p)=>{const{label:d,popConfirm:c}=s;return x(k(k({},s),c),{onConfirm:c==null?void 0:c.confirm,onCancel:c==null?void 0:c.cancel,text:d,divider:p<u.length-1?e.divider:!1})})}),i=P(()=>{var p,d;const s=(((p=t==null?void 0:t.getColumns)==null?void 0:p.call(t))||[]).find(c=>c.flag===pa);return(d=s==null?void 0:s.align)!=null?d:"left"});function l(u){return k({getPopupContainer:()=>{var s;return(s=w(t==null?void 0:t.wrapRef))!=null?s:document.body},placement:"bottom"},pt(u)?{title:u}:u)}function n(u){if(!e.stopButtonPropagation)return;u.composedPath().find(d=>{var c;return((c=d.tagName)==null?void 0:c.toUpperCase())==="BUTTON"})&&u.stopPropagation()}return{prefixCls:a,getActions:g,getDropdownList:m,getAlign:i,onCellClick:n,getTooltip:l}}});function ma(e,a,t,r,o,g){const m=A("Icon"),i=A("PopConfirmButton"),l=A("Tooltip"),n=A("Divider"),u=A("MoreOutlined"),s=A("a-button"),p=A("Dropdown");return _(),E("div",{class:he([e.prefixCls,e.getAlign]),onClick:a[0]||(a[0]=(...d)=>e.onCellClick&&e.onCellClick(...d))},[(_(!0),E(ae,null,ie(e.getActions,(d,c)=>(_(),E(ae,{key:`${c}-${d.label}`},[d.tooltip?(_(),L(l,ne(X({key:0},e.getTooltip(d.tooltip))),{default:$(()=>[v(i,ne(me(d)),{default:$(()=>[d.icon?(_(),L(m,{key:0,icon:d.icon,class:he({"mr-1":!!d.label})},null,8,["icon","class"])):W("",!0),d.label?(_(),E(ae,{key:1},[H(z(d.label),1)],64)):W("",!0)]),_:2},1040)]),_:2},1040)):(_(),L(i,ne(X({key:1},d)),{default:$(()=>[d.icon?(_(),L(m,{key:0,icon:d.icon,class:he({"mr-1":!!d.label})},null,8,["icon","class"])):W("",!0),d.label?(_(),E(ae,{key:1},[H(z(d.label),1)],64)):W("",!0)]),_:2},1040)),e.divider&&c<e.getActions.length-1?(_(),L(n,{key:2,type:"vertical",class:"action-divider"})):W("",!0)],64))),128)),e.dropDownActions&&e.getDropdownList.length>0?(_(),L(p,{key:0,trigger:["hover"],dropMenuList:e.getDropdownList,popconfirm:""},{default:$(()=>[fe(e.$slots,"more"),e.$slots.more?W("",!0):(_(),L(s,{key:0,type:"link",size:"small"},{default:$(()=>[v(u,{class:"icon-more"})]),_:1}))]),_:3},8,["dropMenuList"])):W("",!0)],2)}const Qe=q(fa,[["render",ma]]),ga=j({components:{Image:mt},props:{fileUrl:b.string.def(""),fileName:b.string.def("")}});const ha={class:"thumb"};function va(e,a,t,r,o,g){const m=A("Image");return _(),E("span",ha,[e.fileUrl?(_(),L(m,{key:0,src:e.fileUrl,width:104},null,8,["src"])):W("",!0)])}const Xe=q(ga,[["render",va]]),{t:M}=Y();function ya(){return[{dataIndex:"thumbUrl",title:M("component.upload.legend"),width:100,customRender:({record:e})=>{const{thumbUrl:a}=e||{};return a&&v(Xe,{fileUrl:a},null)}},{dataIndex:"name",title:M("component.upload.fileName"),align:"left",customRender:({text:e,record:a})=>{const{percent:t,status:r}=a||{};let o="normal";return r===B.ERROR?o="exception":r===B.UPLOADING?o="active":r===B.SUCCESS&&(o="success"),v("div",null,[v("p",{class:"truncate mb-1 max-w-[280px]",title:e},[e]),v(gt,{percent:t,size:"small",status:o},null)])}},{dataIndex:"size",title:M("component.upload.fileSize"),width:100,customRender:({text:e=0})=>e&&(e/1024).toFixed(2)+"KB"},{dataIndex:"status",title:M("component.upload.fileStatue"),width:100,customRender:({text:e})=>e===B.SUCCESS?v(ge,{color:"green"},{default:()=>M("component.upload.uploadSuccess")}):e===B.ERROR?v(ge,{color:"red"},{default:()=>M("component.upload.uploadError")}):e===B.UPLOADING?v(ge,{color:"blue"},{default:()=>M("component.upload.uploading")}):e||M("component.upload.pending")}]}function ba(e){return{width:120,title:M("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:a})=>{const t=[{label:M("component.upload.del"),color:"error",onClick:e.bind(null,a)}];return v(Qe,{actions:t,outside:!0},null)}}}function Sa(){return[{dataIndex:"url",title:M("component.upload.legend"),width:100,customRender:({record:e})=>{const{url:a}=e||{};return _e(a)&&v(Xe,{fileUrl:a},null)}},{dataIndex:"name",title:M("component.upload.fileName"),align:"left"}]}function wa({handleRemove:e,handleDownload:a}){return{width:160,title:M("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:t})=>{const r=[{label:M("component.upload.del"),color:"error",onClick:e.bind(null,t)},{label:M("component.upload.download"),onClick:a.bind(null,t)}];return v(Qe,{actions:r,outside:!0},null)}}}const Ye=j({name:"FileList",props:ta,setup(e,{emit:a}){const t=Lt(),r=S();return N(()=>e.dataSource,()=>{Le(()=>{var o;(o=t==null?void 0:t.redoModalHeight)==null||o.call(t)})}),e.openDrag&&Ce(()=>Pt(r,x(k({},e.dragOptions),{onEnd:({oldIndex:o,newIndex:g})=>{if(o===g)return;const{onAfterEnd:m}=e.dragOptions;if(ke(o)&&ke(g)){const i=[...e.dataSource],[l]=i.splice(o,1);i.splice(g,0,l),Le(()=>{a("update:dataSource",i),G(m)&&m(i)})}}})).initSortable()),()=>{const{columns:o,actionColumn:g,dataSource:m}=e,i=[...o,g];return v("div",{class:"overflow-x-auto"},[v("table",{class:"file-table"},[v("colgroup",null,[i.map(l=>{const{width:n=0,dataIndex:u}=l,s={width:`${n}px`,minWidth:`${n}px`};return v("col",{style:n?s:{},key:u},null)})]),v("thead",null,[v("tr",{class:"file-table-tr"},[i.map(l=>{const{title:n="",align:u="center",dataIndex:s}=l;return v("th",{class:["file-table-th",u],key:s},[n])})])]),v("tbody",{ref:r},[m.map((l={},n)=>v("tr",{class:"file-table-tr",key:`${n+l.name||""}`},[i.map(u=>{const{dataIndex:s="",customRender:p,align:d="center"}=u,c=p&&G(p);return v("td",{class:["file-table-td break-all",d],key:s},[c?p==null?void 0:p({text:l[s],record:l}):l[s]])})]))])])])}}});const Ca=j({components:{BasicModal:Ke,Upload:be,Alert:ht,FileList:Ye},props:x(k({},He),{previewFileList:{type:Array,default:()=>[]}}),emits:["change","register","delete"],setup(e,{emit:a}){const t=kt({fileList:[]}),r=S(!1),o=S([]),{accept:g,helpText:m,maxNumber:i,maxSize:l}=je(e),{t:n}=Y(),[u,{closeModal:s}]=We(),{getStringAccept:p,getHelpText:d}=qe({acceptRef:g,helpTextRef:m,maxNumberRef:i,maxSizeRef:l}),{createMessage:c}=Ie(),f=P(()=>o.value.length>0&&!o.value.every(h=>h.status===B.SUCCESS)),I=P(()=>{const h=o.value.some(F=>F.status===B.SUCCESS);return{disabled:r.value||o.value.length===0||!h}}),T=P(()=>{const h=o.value.some(F=>F.status===B.ERROR);return r.value?n("component.upload.uploading"):n(h?"component.upload.reUploadFailed":"component.upload.startUpload")});function O(h){const{size:F,name:U}=h,{maxSize:V}=e;if(V&&h.size/1024/1024>=V)return c.error(n("component.upload.maxSizeMultiple",[V])),!1;const Q={uuid:Tt(),file:h,size:F,name:U,percent:0,type:U.split(".").pop()};return aa(h)?na(h).then(({result:te})=>{o.value=[...w(o),k({thumbUrl:te},Q)]}):o.value=[...w(o),Q],!1}function K(h){const F=o.value.findIndex(U=>U.uuid===h.uuid);F!==-1&&o.value.splice(F,1),a("delete",h)}function J(h){return D(this,null,function*(){var U;const{api:F}=e;if(!F||!G(F))return Ue();try{h.status=B.UPLOADING;const V=yield(U=e.api)==null?void 0:U.call(e,{data:k({},e.uploadParams||{}),file:h.file,name:e.name,filename:e.filename},function(Ae){const Je=Ae.loaded/Ae.total*100|0;h.percent=Je}),{data:Q}=V;return h.status=B.SUCCESS,h.response=Q,{success:!0,error:null}}catch(V){return h.status=B.ERROR,{success:!1,error:V}}})}function Z(){return D(this,null,function*(){var F;const{maxNumber:h}=e;if(o.value.length+((F=e.previewFileList)==null?void 0:F.length)>h)return c.warning(n("component.upload.maxNumber",[h]));try{r.value=!0;const U=o.value.filter(te=>te.status!==B.SUCCESS)||[],V=yield Promise.all(U.map(te=>J(te)));r.value=!1;const Q=V.filter(te=>!te.success);if(Q.length>0)throw Q}catch(U){throw r.value=!1,U}})}function C(){const{maxNumber:h}=e;if(o.value.length>h)return c.warning(n("component.upload.maxNumber",[h]));if(r.value)return c.warning(n("component.upload.saveWarn"));const F=[];for(const U of o.value){const{status:V,response:Q}=U;V===B.SUCCESS&&Q&&F.push(Q.url)}if(F.length<=0)return c.warning(n("component.upload.saveError"));o.value=[],s(),a("change",F)}function R(){return D(this,null,function*(){return r.value?(c.warning(n("component.upload.uploadWait")),!1):(o.value=[],!0)})}return{columns:ya(),actionColumn:ba(K),register:u,closeModal:s,getHelpText:d,getStringAccept:p,getOkButtonProps:I,beforeUpload:O,fileListRef:o,state:t,isUploadingRef:r,handleStartUpload:Z,handleOk:C,handleCloseFunc:R,getIsSelectFile:f,getUploadBtnText:T,t:n}}});const _a={class:"upload-modal-toolbar"};function Aa(e,a,t,r,o,g){const m=A("a-button"),i=A("Alert"),l=A("Upload"),n=A("FileList"),u=A("BasicModal");return _(),L(u,X({width:"800px",title:e.t("component.upload.upload"),okText:e.t("component.upload.save")},e.$attrs,{onRegister:e.register,onOk:e.handleOk,closeFunc:e.handleCloseFunc,maskClosable:!1,keyboard:!1,class:"upload-modal",okButtonProps:e.getOkButtonProps,cancelButtonProps:{disabled:e.isUploadingRef}}),{centerFooter:$(()=>[v(m,{onClick:e.handleStartUpload,color:"success",disabled:!e.getIsSelectFile,loading:e.isUploadingRef},{default:$(()=>[H(z(e.getUploadBtnText),1)]),_:1},8,["onClick","disabled","loading"])]),default:$(()=>[le("div",_a,[v(i,{message:e.getHelpText,type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),v(l,{accept:e.getStringAccept,multiple:e.multiple,"before-upload":e.beforeUpload,"show-upload-list":!1,class:"upload-modal-toolbar__btn"},{default:$(()=>[v(m,{type:"primary"},{default:$(()=>[H(z(e.t("component.upload.choose")),1)]),_:1})]),_:1},8,["accept","multiple","before-upload"])]),v(n,{dataSource:e.fileListRef,"onUpdate:dataSource":a[0]||(a[0]=s=>e.fileListRef=s),columns:e.columns,actionColumn:e.actionColumn,openDrag:e.fileListOpenDrag,dragOptions:e.fileListDragOptions},null,8,["dataSource","columns","actionColumn","openDrag","dragOptions"])]),_:1},16,["title","okText","onRegister","onOk","closeFunc","okButtonProps","cancelButtonProps"])}const Fa=q(Ca,[["render",Aa]]),$a=j({components:{BasicModal:Ke,FileList:Ye},props:ea,emits:["list-change","register","delete"],setup(e,{emit:a}){const[t,{closeModal:r}]=We(),{t:o}=Y(),g=S([]);N(()=>e.value,l=>{oe(l)||(l=[]),g.value=l.filter(n=>!!n).map(n=>({url:n,type:n.split(".").pop()||"",name:n.split("/").pop()||""}))},{immediate:!0});function m(l){const n=g.value.findIndex(u=>u.url===l.url);if(n!==-1){const u=g.value.splice(n,1);a("delete",u[0].url),a("list-change",g.value.map(s=>s.url))}}function i(l){const{url:n=""}=l;Ot({url:n})}return{t:o,register:t,closeModal:r,fileListRef:g,columns:Sa(),actionColumn:wa({handleRemove:m,handleDownload:i})}}});function ka(e,a,t,r,o,g){const m=A("FileList"),i=A("BasicModal");return _(),L(i,X({width:"800px",title:e.t("component.upload.preview"),class:"upload-preview-modal"},e.$attrs,{onRegister:e.register,showOkBtn:!1}),{default:$(()=>[v(m,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","onRegister"])}const Ra=q($a,[["render",ka]]),La=j({name:"BasicUpload",components:{UploadModal:Fa,Space:vt,UploadPreviewModal:Ra,Icon:Oe,Tooltip:Ee},props:Ve,emits:["change","delete","preview-delete","update:value"],setup(e,{emit:a,attrs:t}){const{t:r}=Y(),[o,{openModal:g}]=Te(),[m,{openModal:i}]=Te(),l=S([]),n=P(()=>{const{emptyHidePreview:f}=e;return f&&f?l.value.length>0:!0}),u=P(()=>{const f=k(k({},t),e);return se(f,"onChange")});N(()=>e.value,(f=[])=>{l.value=oe(f)?f:[]},{immediate:!0});function s(f){l.value=[...w(l),...f||[]],a("update:value",l.value),a("change",l.value)}function p(f){l.value=[...f||[]],a("update:value",l.value),a("change",l.value)}function d(f){a("delete",f)}function c(f){a("preview-delete",f)}return{registerUploadModal:o,openUploadModal:g,handleChange:s,handlePreviewChange:p,registerPreviewModal:m,openPreviewModal:i,fileList:l,showPreview:n,bindValue:u,handleDelete:d,handlePreviewDelete:c,t:r}}});function Ta(e,a,t,r,o,g){const m=A("a-button"),i=A("Icon"),l=A("Tooltip"),n=A("Space"),u=A("UploadModal"),s=A("UploadPreviewModal");return _(),E("div",null,[v(n,null,{default:$(()=>[v(m,{type:"primary",onClick:e.openUploadModal,preIcon:"carbon:cloud-upload"},{default:$(()=>[H(z(e.t("component.upload.upload")),1)]),_:1},8,["onClick"]),e.showPreview?(_(),L(l,{key:0,placement:"bottom"},{title:$(()=>[H(z(e.t("component.upload.uploaded"))+" ",1),e.fileList.length?(_(),E(ae,{key:0},[H(z(e.fileList.length),1)],64)):W("",!0)]),default:$(()=>[v(m,{onClick:e.openPreviewModal},{default:$(()=>[v(i,{icon:"bi:eye"}),e.fileList.length&&e.showPreviewNumber?(_(),E(ae,{key:0},[H(z(e.fileList.length),1)],64)):W("",!0)]),_:1},8,["onClick"])]),_:1})):W("",!0)]),_:1}),v(u,X(e.bindValue,{previewFileList:e.fileList,fileListOpenDrag:e.fileListOpenDrag,fileListDragOptions:e.fileListDragOptions,onRegister:e.registerUploadModal,onChange:e.handleChange,onDelete:e.handleDelete}),null,16,["previewFileList","fileListOpenDrag","fileListDragOptions","onRegister","onChange","onDelete"]),v(s,{value:e.fileList,onRegister:e.registerPreviewModal,onListChange:e.handlePreviewChange,onDelete:e.handlePreviewDelete},null,8,["value","onRegister","onListChange","onDelete"])])}const Pa=q(La,[["render",Ta]]),Oa={key:0},Ia={style:{"margin-top":"8px"}},Ua=["src"],Da=j({__name:"ImageUpload",props:k({},Ve),emits:["change","update:value","delete"],setup(e,{emit:a}){const t=e,{t:r}=Y(),{createMessage:o}=Ie(),{accept:g,helpText:m,maxNumber:i,maxSize:l}=je(t),{getStringAccept:n}=qe({acceptRef:g,helpTextRef:m,maxNumberRef:i,maxSizeRef:l}),u=S(!1),s=S(""),p=S(""),d=S([]),c=S(!0),f=S(!0);N(()=>t.value,C=>{oe(C)&&(d.value=C.map((R,h)=>({uid:String(-h),name:R?R.substring(R.lastIndexOf("/")+1):"image.png",status:"done",url:R})))},{immediate:!0,deep:!0});function I(C){return new Promise((R,h)=>{const F=new FileReader;F.readAsDataURL(C),F.onload=()=>R(F.result),F.onerror=U=>h(U)})}const T=C=>D(this,null,function*(){!C.url&&!C.preview&&(C.preview=yield I(C.originFileObj)),s.value=C.url||C.preview,u.value=!0,p.value=C.name||C.url.substring(C.url.lastIndexOf("/")+1)}),O=C=>D(this,null,function*(){if(d.value){const R=d.value.findIndex(h=>h.uuid===C.uuid);R!==-1&&d.value.splice(R,1),a("change",d.value),a("delete",C)}}),K=()=>{u.value=!1,p.value=""},J=C=>{const{maxSize:R,accept:h}=t,{name:F}=C;return f.value=_e(F),f.value||(o.error(r("component.upload.acceptUpload",[h])),f.value=!1,setTimeout(()=>f.value=!0,1e3)),c.value=C.size/1024/1024>R,c.value&&(o.error(r("component.upload.maxSizeMultiple",[R])),c.value=!1,setTimeout(()=>c.value=!0,1e3)),f.value&&!c.value||be.LIST_IGNORE};function Z(C){return D(this,null,function*(){var h;const{api:R}=t;if(!R||!G(R))return Ue();try{const F=yield(h=t.api)==null?void 0:h.call(t,{data:k({},t.uploadParams||{}),file:C.file,name:t.name,filename:t.filename});C.onSuccess(F.data),a("change",d.value)}catch(F){C.onError(F)}})}return(C,R)=>(_(),E("div",null,[v(w(be),X(C.$attrs,{"file-list":d.value,"onUpdate:fileList":R[0]||(R[0]=h=>d.value=h),"list-type":C.listType,accept:w(n),"before-upload":J,"custom-request":Z,onPreview:T,onRemove:O}),{default:$(()=>[d.value&&d.value.length<w(i)?(_(),E("div",Oa,[v(w(yt)),le("div",Ia,z(w(r)("component.upload.upload")),1)])):W("",!0)]),_:1},16,["file-list","list-type","accept"]),v(w(bt),{open:u.value,title:p.value,footer:null,onCancel:K},{default:$(()=>[le("img",{alt:"",style:{width:"100%"},src:s.value},null,8,Ua)]),_:1},8,["open","title"])]))}});const Ba=De(Da),Ma=De(Pa),y=new Map;y.set("Input",re);y.set("InputGroup",re.Group);y.set("InputPassword",re.Password);y.set("InputSearch",re.Search);y.set("InputTextArea",re.TextArea);y.set("InputNumber",St);y.set("AutoComplete",wt);y.set("ImageUpload",Ba);y.set("Select",Be);y.set("ApiSelect",Gt);y.set("ApiTree",Wt);y.set("TreeSelect",Me);y.set("ApiTreeSelect",qt);y.set("ApiRadioGroup",Nt);y.set("Switch",Ct);y.set("RadioButtonGroup",Rt);y.set("RadioGroup",ue.Group);y.set("Checkbox",ze);y.set("CheckboxGroup",ze.Group);y.set("ApiCascader",Xt);y.set("Cascader",ye);y.set("Slider",_t);y.set("Rate",At);y.set("ApiTransfer",xt);y.set("DatePicker",de);y.set("MonthPicker",de.MonthPicker);y.set("RangePicker",de.RangePicker);y.set("WeekPicker",de.WeekPicker);y.set("TimePicker",Ge);y.set("TimeRangePicker",Ge.TimeRangePicker);y.set("StrengthMeter",It);y.set("IconPicker",Ut);y.set("InputCountDown",Dt);y.set("Upload",Ma);y.set("Divider",Ne);function rn(e,a){y.set(e,a)}export{Gt as A,Ma as B,ln as D,tn as F,sn as I,en as P,Ja as R,Qe as T,xa as a,qt as b,y as c,Nt as d,pa as e,nn as f,on as g,an as h,Ya as i,rn as j,oa as u};
